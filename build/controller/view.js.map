{"version":3,"file":"controller/view.js","mappings":"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","sources":["webpack://@pewresearch/prc-chart-builder/webpack/bootstrap","webpack://@pewresearch/prc-chart-builder/webpack/runtime/define property getters","webpack://@pewresearch/prc-chart-builder/webpack/runtime/hasOwnProperty shorthand","webpack://@pewresearch/prc-chart-builder/external module \"@wordpress/interactivity\"","webpack://@pewresearch/prc-chart-builder/./src/controller/view.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"getContext\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getContext), [\"getElement\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getElement), [\"store\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.store) });","/**\n * WordPress Dependencies\n */\nimport { store, getElement, getContext } from '@wordpress/interactivity';\n\nconst { arrayToCSV } = window.prcFunctions;\nconst { addQueryArgs } = window.wp.url;\nconst { innerWidth, innerHeight } = window;\n\nconst { state } = store('prc-block/chart-builder-controller', {\n\tstate: {\n\t\tget isActive() {\n\t\t\tconst context = getContext();\n\t\t\tconst { id } = context;\n\t\t\tconst element = getElement();\n\t\t\treturn (\n\t\t\t\telement.attributes['data-chart-view'] === state[id].activeTab ||\n\t\t\t\t(element.attributes['data-allow-overlay'] &&\n\t\t\t\t\tstate[id].activeTab === 'share')\n\t\t\t);\n\t\t},\n\t},\n\tactions: {\n\t\tsetActiveTab() {\n\t\t\tconst context = getContext();\n\t\t\tconst { id } = context;\n\t\t\tconst element = getElement();\n\t\t\tstate[id].activeTab = element.attributes['data-chart-view'];\n\t\t},\n\t\thideModal() {\n\t\t\tconst context = getContext();\n\t\t\tconst { id } = context;\n\t\t\tstate[id].activeTab = 'chart';\n\t\t},\n\t\tshareTwitter() {\n\t\t\tconst context = getContext();\n\t\t\tconst { postId, postUrl, rootUrl, title, featuredImageId } =\n\t\t\t\tcontext;\n\t\t\tconst actionUrl = addQueryArgs('https://twitter.com/intent/tweet', {\n\t\t\t\ttext: title,\n\t\t\t\turl: featuredImageId\n\t\t\t\t\t? `${rootUrl}/share/${postId}/${featuredImageId}`\n\t\t\t\t\t: postUrl,\n\t\t\t});\n\t\t\twindow.open(\n\t\t\t\tactionUrl,\n\t\t\t\t'twtrShareWindow',\n\t\t\t\t`height=450, width=550, top=${innerHeight / 2 - 275}, left=${\n\t\t\t\t\tinnerWidth / 2 - 225\n\t\t\t\t}, toolbar=0, location=0, menubar=0, directories=0, scrollbars=0`\n\t\t\t);\n\t\t},\n\t\tshareFacebook() {\n\t\t\tconst context = getContext();\n\t\t\tconst { postId, postUrl, rootUrl, featuredImageId } = context;\n\t\t\tconst actionUrl = addQueryArgs(\n\t\t\t\t'https://www.facebook.com/sharer/sharer.php',\n\t\t\t\t{\n\t\t\t\t\tu: featuredImageId\n\t\t\t\t\t\t? `${rootUrl}/share/${postId}/${featuredImageId}`\n\t\t\t\t\t\t: postUrl,\n\t\t\t\t}\n\t\t\t);\n\t\t\twindow.open(\n\t\t\t\tactionUrl,\n\t\t\t\t'fbShareWindow',\n\t\t\t\t`height=450, width=550, top=${innerHeight / 2 - 275}, left=${\n\t\t\t\t\tinnerWidth / 2 - 225\n\t\t\t\t}, toolbar=0, location=0, menubar=0, directories=0, scrollbars=0`\n\t\t\t);\n\t\t},\n\t\tdownloadData(event) {\n\t\t\tconst context = getContext();\n\t\t\tconst {\n\t\t\t\ttableData,\n\t\t\t\ttitle,\n\t\t\t\tsubtitle,\n\t\t\t\tnote,\n\t\t\t\tsource,\n\t\t\t\ttag,\n\t\t\t\tpostPubDate,\n\t\t\t} = context;\n\t\t\t// If the event is a keydown event and the key is not Enter or space, return\n\t\t\tif (\n\t\t\t\tevent.type === 'keydown' &&\n\t\t\t\t(event.key !== 'Enter' || event.key !== ' ')\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!tableData) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst csv = arrayToCSV([tableData.header, ...tableData.rows], {\n\t\t\t\ttitle,\n\t\t\t\tsubtitle,\n\t\t\t\tnote,\n\t\t\t\tsource,\n\t\t\t\ttag,\n\t\t\t});\n\t\t\tconst blob = new Blob([csv], { type: 'text/csv' });\n\t\t\tconst url = URL.createObjectURL(blob);\n\t\t\tconst downloadLink = document.createElement('a');\n\t\t\tconst csvTitle = title.toLowerCase().replace(/\\s+/g, '_');\n\t\t\tdownloadLink.setAttribute('href', url);\n\t\t\tdownloadLink.setAttribute(\n\t\t\t\t'download',\n\t\t\t\t`${csvTitle}_data_${postPubDate}.csv`\n\t\t\t);\n\t\t\tdownloadLink.click();\n\t\t},\n\t\tdownloadSVG() {\n\t\t\tconst context = getContext();\n\t\t\tconst { id } = context;\n\t\t\tconst controllerEl = document.getElementById(id);\n\t\t\tconst svg = controllerEl.querySelector('svg');\n\t\t\tsvg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n\t\t\tsvg.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\n\t\t\tconst blob = new Blob([svg.outerHTML], { type: 'image/svg+xml' });\n\t\t\tconst url = URL.createObjectURL(blob);\n\t\t\tconst downloadLink = document.createElement('a');\n\t\t\tdownloadLink.href = url;\n\t\t\tdownloadLink.download = `chart-${id}.svg`;\n\t\t\tdocument.body.appendChild(downloadLink);\n\t\t\tdownloadLink.click();\n\t\t\tdocument.body.removeChild(downloadLink);\n\t\t},\n\t},\n\tcallbacks: {\n\t\t// onRun: () => {\n\t\t// \tconst context = getContext();\n\t\t// \tconsole.log('context', context);\n\t\t// },\n\t},\n});\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__","x","d","arrayToCSV","window","prcFunctions","addQueryArgs","wp","url","innerWidth","innerHeight","state","store","isActive","context","getContext","id","element","getElement","attributes","activeTab","actions","setActiveTab","hideModal","shareTwitter","postId","postUrl","rootUrl","title","featuredImageId","actionUrl","text","open","shareFacebook","u","downloadData","event","tableData","subtitle","note","source","tag","postPubDate","type","csv","header","rows","blob","Blob","URL","createObjectURL","downloadLink","document","createElement","csvTitle","toLowerCase","replace","setAttribute","click","downloadSVG","svg","getElementById","querySelector","outerHTML","href","download","body","appendChild","removeChild","callbacks"],"sourceRoot":""}