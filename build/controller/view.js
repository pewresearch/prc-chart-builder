import{getContext as t,getElement as e,store as r}from"@wordpress/interactivity";const{addQueryArgs:o}=window.wp.url,{innerWidth:a,innerHeight:i}=window,{state:n,actions:s}=r("prc-block/chart-builder-controller",{state:{get isActive(){const r=t(),{id:o}=r,a=e();return a.attributes["data-chart-view"]===n[o].activeTab||a.attributes["data-allow-overlay"]&&"share"===n[o].activeTab}},callbacks:{detectWebShareSupport(){void 0===window.navigator.share?n.webShareSupported=!1:n.webShareSupported=!0}},actions:{setActiveTab(r){r.preventDefault();const o=t(),{id:a}=o,i=e();"share"===i.attributes["data-chart-view"]&&n.webShareSupported?s.shareNative():n[a].activeTab=i.attributes["data-chart-view"]},hideModal(){const e=t(),{id:r}=e;n[r].activeTab="chart"},shareNative:()=>{const e=t(),{postId:r,postUrl:o,rootUrl:a,title:i,featuredImageId:s}=e,d=s?`${a}/share/${r}/${s}`:o;!0===n.webShareSupported&&window.navigator.share({title:i+" | Pew Research Center",url:d})},shareTwitter(){const e=t(),{postId:r,postUrl:n,rootUrl:s,title:d,featuredImageId:l}=e,c=o("https://twitter.com/intent/tweet",{text:d,url:l?`${s}/share/${r}/${l}`:n});window.open(c,"twtrShareWindow",`height=450, width=550, top=${i/2-275}, left=${a/2-225}, toolbar=0, location=0, menubar=0, directories=0, scrollbars=0`)},shareBluesky(){const e=t(),{postId:r,postUrl:n,rootUrl:s,title:d,featuredImageId:l}=e,c=o("https://bsky.app/intent/compose",{text:`${d} ${l?`${s}/share/${r}/${l}`:n}`});window.open(c,"bskyShareWindow",`height=450, width=550, top=${i/2-275}, left=${a/2-225}, toolbar=0, location=0, menubar=0, directories=0, scrollbars=0`)},shareFacebook(){const e=t(),{postId:r,postUrl:n,rootUrl:s,featuredImageId:d}=e,l=o("https://www.facebook.com/sharer/sharer.php",{u:d?`${s}/share/${r}/${d}`:n});window.open(l,"fbShareWindow",`height=450, width=550, top=${i/2-275}, left=${a/2-225}, toolbar=0, location=0, menubar=0, directories=0, scrollbars=0`)},downloadData(e){const r=t(),{tableData:o,title:a,subtitle:i,note:n,source:s,tag:d,postPubDate:l}=r;if("keydown"===e.type&&("Enter"!==e.key||" "!==e.key))return;if(!o)return;const c=function(t,e){if(void 0===t||0===t.length)return!1;const r=t,o=t=>void 0!==t?t:"";let a="";void 0!==e&&(a+=`${o(e.title)}\n\t\t\t${o(e.subtitle)}\n\n\t\t\t`);for(let t=0;t<r.length;t+=1){let e="";for(let o=0;o<r[t].length;o+=1)o>0&&(e+=","),r[t][o].indexOf(",")>-1?e+=`"${r[t][o]}"`:e+=r[t][o];a+=`${e}\n\t\t`}return void 0!==e&&(a+=`\n\t\t${o(e.note)}\n\t\t${o(e.source)}\n\t\t${o(e.tag)}`),a}([o.header,...o.rows],{title:a,subtitle:i,note:n,source:s,tag:d}),h=new Blob([c],{type:"text/csv"}),w=URL.createObjectURL(h),u=document.createElement("a"),b=a.toLowerCase().replace(/\s+/g,"_");u.setAttribute("href",w),u.setAttribute("download",`${b}_data_${l}.csv`),u.click()},downloadSVG(){const e=t(),{id:r}=e,o=document.getElementById(r).querySelector("svg");o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");const a=new Blob([o.outerHTML],{type:"image/svg+xml"}),i=URL.createObjectURL(a),n=document.createElement("a");n.href=i,n.download=`chart-${r}.svg`,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}});
//# sourceMappingURL=view.js.map